<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>T4BF // Bonus Features Guide</title>
  <link rel="icon" type="image/svg+xml" href="favicon.svg">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/main.css">
</head>
<body>

<!-- ====== NAV ====== -->
<nav class="nav">
  <span class="nav-brand">T4BF // BONUS FEATURES</span>
  <button class="hamburger" aria-label="Toggle menu">[=]</button>
  <ul class="nav-links">
    <li><a href="#overview">Overview</a></li>
    <li><a href="#feature-a">Startup</a></li>
    <li><a href="#feature-b">Colors</a></li>
    <li><a href="#feature-c">History</a></li>
    <li><a href="#feature-d">Clear</a></li>
    <li><a href="#feature-e">Alias</a></li>
    <li><a href="#feature-f">Custom</a></li>
    <li><a href="#ansi-ref">ANSI Ref</a></li>
  </ul>
</nav>

<!-- ====== HERO ====== -->
<main>
<section class="hero" id="top">
  <div class="hero-ascii" aria-hidden="true">
 _______  _  _     ____    ______
|__   __|| || |   |  _ \  |  ____|
   | |   | || |_  | |_) | | |__
   | |   |__   _| |  _ &lt;  |  __|
   | |      | |   | |_) | | |
   |_|      |_|   |____/  |_|
  </div>
  <p class="hero-tagline" data-text="Bonus feature implementation guide for MPX bare-metal OS">Bonus feature implementation guide for MPX bare-metal OS</p>
  <p class="hero-meta">5 pts each &middot; max 20 pts for first 4 &middot; CS450 Spring 2026</p>
</section>

<!-- ====== OVERVIEW ====== -->
<section id="overview">
  <p class="section-title">$ cat overview.txt</p>
  <h2>Feature Overview</h2>

  <div class="feature-grid">
    <div class="feature-card">
      <div class="feature-card-header">
        <span class="badge">A</span>
        <div>
          <div class="feature-card-name">Unique Startup</div>
          <span class="pill pill-easy">Easy</span>
        </div>
      </div>
      <p class="feature-card-desc">Display custom ASCII art when MPX boots up.</p>
    </div>

    <div class="feature-card">
      <div class="feature-card-header">
        <span class="badge">B</span>
        <div>
          <div class="feature-card-name">Variable Text Color</div>
          <span class="pill pill-medium">Easy-Med</span>
        </div>
      </div>
      <p class="feature-card-desc">Add ANSI color output to commands and prompts.</p>
    </div>

    <div class="feature-card">
      <div class="feature-card-header">
        <span class="badge">C</span>
        <div>
          <div class="feature-card-name">Command History</div>
          <span class="pill pill-easy">Easy</span>
        </div>
      </div>
      <p class="feature-card-desc">Arrow-key history recall. Already ~90% done!</p>
    </div>

    <div class="feature-card">
      <div class="feature-card-header">
        <span class="badge">D</span>
        <div>
          <div class="feature-card-name">Clear Command</div>
          <span class="pill pill-easy">Easiest</span>
        </div>
      </div>
      <p class="feature-card-desc">Clear the terminal with a single ANSI sequence.</p>
    </div>

    <div class="feature-card">
      <div class="feature-card-header">
        <span class="badge">E</span>
        <div>
          <div class="feature-card-name">Alias Command</div>
          <span class="pill pill-hard">Med-Hard</span>
        </div>
      </div>
      <p class="feature-card-desc">Map shorthand names to existing commands.</p>
    </div>

    <div class="feature-card">
      <div class="feature-card-header">
        <span class="badge">F</span>
        <div>
          <div class="feature-card-name">Other Approved</div>
          <span class="pill pill-medium">Varies</span>
        </div>
      </div>
      <p class="feature-card-desc">Tab completion, command timing, custom prompt, etc.</p>
    </div>
  </div>

  <h3>Key Files</h3>
  <table class="key-files-table">
    <thead>
      <tr>
        <th>Feature</th>
        <th>Files Touched</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><span class="badge" style="width:1.5rem;height:1.5rem;font-size:0.7rem">A</span> Startup</td>
        <td><code>user/comhand.c</code></td>
      </tr>
      <tr>
        <td><span class="badge" style="width:1.5rem;height:1.5rem;font-size:0.7rem">B</span> Colors</td>
        <td><code>user/cmd_helpers.c</code></td>
      </tr>
      <tr>
        <td><span class="badge" style="width:1.5rem;height:1.5rem;font-size:0.7rem">C</span> History</td>
        <td><code>kernel/kmain.c</code>, <code>kernel/serial.c</code></td>
      </tr>
      <tr>
        <td><span class="badge" style="width:1.5rem;height:1.5rem;font-size:0.7rem">D</span> Clear</td>
        <td><code>user/cmd_clear.c</code> <em>(new)</em>, <code>include/cmd_clear.h</code> <em>(new)</em>, <code>user/comhand.c</code>, <code>make/user.mk</code></td>
      </tr>
      <tr>
        <td><span class="badge" style="width:1.5rem;height:1.5rem;font-size:0.7rem">E</span> Alias</td>
        <td><code>user/cmd_alias.c</code> <em>(new)</em>, <code>include/cmd_alias.h</code> <em>(new)</em>, <code>user/comhand.c</code>, <code>make/user.mk</code></td>
      </tr>
    </tbody>
  </table>
</section>

<!-- ====== FEATURE A: UNIQUE STARTUP ====== -->
<section id="feature-a">
<div class="feature-section">
  <div class="feature-header">
    <span class="badge">A</span>
    <h2>Unique Startup Message</h2>
    <div class="pills">
      <span class="pill pill-pts">5 pts</span>
      <span class="pill pill-easy">Easy</span>
    </div>
  </div>

  <div class="subsection">
    <h3>Overview</h3>
    <p>Display custom ASCII art or a welcome banner when MPX starts. This is the simplest bonus feature &mdash; just add <code>print()</code> calls at the top of the command handler loop.</p>
  </div>

  <div class="subsection">
    <h3>Files to Modify</h3>
    <ul class="file-list">
      <li><span class="file-path">user/comhand.c</span> &mdash; Add print statements at line 36, before the main loop</li>
    </ul>
  </div>

  <div class="subsection">
    <h3>Implementation</h3>
    <ol class="steps">
      <li>Open <code>user/comhand.c</code></li>
      <li>Find the <code>comhand()</code> function (line 29)</li>
      <li>Replace the generic welcome message at lines 36-38 with your ASCII art</li>
    </ol>

    <div class="code-block">
      <div class="code-block-header">
        <span>user/comhand.c — lines 29-42</span>
        <button class="copy-btn">copy</button>
      </div>
<pre><span class="kw">void</span> <span class="fn">comhand</span>(<span class="kw">void</span>)
{
    <span class="type">char</span> buffer[BUF_SIZE];
    <span class="type">char</span> *cmd;
    <span class="type">char</span> *arg;
    <span class="type">int</span> running = <span class="num">1</span>;

    <span class="cmt">// === YOUR ASCII ART HERE ===</span>
    <span class="fn">print</span>(<span class="str">"\r\n"</span>);
    <span class="fn">print</span>(<span class="str">"  _______  _  _     ____    ______ \r\n"</span>);
    <span class="fn">print</span>(<span class="str">" |__   __|| || |   |  _ \\  |  ____|\r\n"</span>);
    <span class="fn">print</span>(<span class="str">"    | |   | || |_  | |_) | | |__   \r\n"</span>);
    <span class="fn">print</span>(<span class="str">"    | |   |__   _| |  _ &lt;  |  __|  \r\n"</span>);
    <span class="fn">print</span>(<span class="str">"    | |      | |   | |_) | | |     \r\n"</span>);
    <span class="fn">print</span>(<span class="str">"    |_|      |_|   |____/  |_|     \r\n"</span>);
    <span class="fn">print</span>(<span class="str">"\r\n"</span>);
    <span class="fn">print</span>(<span class="str">"Type 'help' for a list of commands.\r\n\r\n"</span>);

    <span class="kw">while</span> (running)
    {</pre>
    </div>
  </div>

  <div class="tip">
    <div class="tip-label">TIP</div>
    <p>Keep ASCII art under 80 columns wide so it doesn't wrap in the terminal. Remember to use <code>\r\n</code> for line endings (not just <code>\n</code>) since this is a serial console. Combine with Feature B for colored ASCII art!</p>
  </div>
</div>
</section>

<!-- ====== FEATURE B: VARIABLE TEXT COLOR ====== -->
<section id="feature-b">
<div class="feature-section">
  <div class="feature-header">
    <span class="badge">B</span>
    <h2>Variable Text Color</h2>
    <div class="pills">
      <span class="pill pill-pts">5 pts</span>
      <span class="pill pill-medium">Easy-Med</span>
    </div>
  </div>

  <div class="subsection">
    <h3>Overview</h3>
    <p>Add ANSI escape code color output to your commands, prompts, and error messages. This works because <code>print()</code> calls <code>sys_req(WRITE, COM1, ...)</code>, which passes raw bytes through the serial port &mdash; and your terminal emulator interprets ANSI sequences automatically.</p>
  </div>

  <div class="subsection">
    <h3>Files to Modify</h3>
    <ul class="file-list">
      <li><span class="file-path">user/cmd_helpers.c</span> &mdash; Add color helper functions</li>
      <li><span class="file-path">include/cmd_helpers.h</span> &mdash; Declare the new prototypes</li>
    </ul>
  </div>

  <div class="subsection">
    <h3>How ANSI Colors Work</h3>
    <p>ANSI escape sequences start with <code>\033[</code> (ESC + <code>[</code>) followed by a numeric code and the letter <code>m</code>. Wrap your text between a color code and the reset code <code>\033[0m</code>.</p>
    <div class="code-block">
      <div class="code-block-header">
        <span>Pattern</span>
        <button class="copy-btn">copy</button>
      </div>
<pre><span class="fn">print</span>(<span class="str">"\033[32mThis text is green!\033[0m\r\n"</span>);
<span class="cmt">//     ^^^^^                  ^^^^^^</span>
<span class="cmt">//     set green              reset to default</span></pre>
    </div>
  </div>

  <div class="subsection">
    <h3>Implementation</h3>
    <ol class="steps">
      <li>Add color helper functions to <code>user/cmd_helpers.c</code></li>
      <li>Declare prototypes in <code>include/cmd_helpers.h</code></li>
      <li>Use them anywhere you call <code>print()</code></li>
    </ol>

    <div class="code-block">
      <div class="code-block-header">
        <span>user/cmd_helpers.c — color helpers</span>
        <button class="copy-btn">copy</button>
      </div>
<pre><span class="cmt">// Color helper: print colored text then reset</span>
<span class="kw">void</span> <span class="fn">print_color</span>(<span class="kw">const</span> <span class="type">char</span> *color_code, <span class="kw">const</span> <span class="type">char</span> *text)
{
    <span class="fn">print</span>(color_code);
    <span class="fn">print</span>(text);
    <span class="fn">print</span>(<span class="str">"\033[0m"</span>);  <span class="cmt">// reset</span>
}

<span class="cmt">// Convenience wrappers</span>
<span class="kw">void</span> <span class="fn">print_green</span>(<span class="kw">const</span> <span class="type">char</span> *text)  { <span class="fn">print_color</span>(<span class="str">"\033[32m"</span>, text); }
<span class="kw">void</span> <span class="fn">print_red</span>(<span class="kw">const</span> <span class="type">char</span> *text)    { <span class="fn">print_color</span>(<span class="str">"\033[31m"</span>, text); }
<span class="kw">void</span> <span class="fn">print_yellow</span>(<span class="kw">const</span> <span class="type">char</span> *text) { <span class="fn">print_color</span>(<span class="str">"\033[33m"</span>, text); }
<span class="kw">void</span> <span class="fn">print_cyan</span>(<span class="kw">const</span> <span class="type">char</span> *text)   { <span class="fn">print_color</span>(<span class="str">"\033[36m"</span>, text); }
<span class="kw">void</span> <span class="fn">print_bold</span>(<span class="kw">const</span> <span class="type">char</span> *text)   { <span class="fn">print_color</span>(<span class="str">"\033[1m"</span>, text); }</pre>
    </div>

    <div class="code-block">
      <div class="code-block-header">
        <span>Usage example in comhand.c</span>
        <button class="copy-btn">copy</button>
      </div>
<pre><span class="cmt">// Colored prompt</span>
<span class="fn">print_green</span>(<span class="str">"mpx"</span>);
<span class="fn">print</span>(<span class="str">"> "</span>);

<span class="cmt">// Colored error</span>
<span class="fn">print_red</span>(<span class="str">"Error: "</span>);
<span class="fn">print</span>(<span class="str">"Unknown command\r\n"</span>);</pre>
    </div>
  </div>

  <div class="tip">
    <div class="tip-label">TIP</div>
    <p>Always reset with <code>\033[0m</code> after colored text, or all subsequent output will stay colored. You can combine codes: <code>\033[1;32m</code> = bold green.</p>
  </div>
</div>
</section>

<!-- ====== FEATURE C: COMMAND HISTORY ====== -->
<section id="feature-c">
<div class="feature-section">
  <div class="feature-header">
    <span class="badge">C</span>
    <h2>Command History</h2>
    <div class="pills">
      <span class="pill pill-pts">5 pts</span>
      <span class="pill pill-easy">Easy</span>
    </div>
  </div>

  <div class="subsection">
    <h3>Overview</h3>
    <p>Scroll through previously entered commands with the up/down arrow keys. <strong>This is already ~90% implemented!</strong> The data structures and arrow-key handling exist in <code>kernel/serial.c</code>. You just need two small fixes.</p>
  </div>

  <div class="subsection">
    <h3>What Already Exists</h3>
    <ul class="file-list">
      <li><span class="file-path">include/mpx/serial.h:13-24</span> &mdash; <code>cmd_node_t</code> and <code>cmd_history_t</code> structs (linked list of commands, capacity 16)</li>
      <li><span class="file-path">kernel/serial.c:107-118</span> &mdash; <code>init_history()</code> function</li>
      <li><span class="file-path">kernel/serial.c:125-161</span> &mdash; <code>add_command()</code> function (called on Enter key)</li>
      <li><span class="file-path">kernel/serial.c:211-258</span> &mdash; Up/down arrow handling (copies history command into input buffer)</li>
    </ul>
  </div>

  <div class="subsection">
    <h3>Existing Data Structures</h3>
    <div class="code-block">
      <div class="code-block-header">
        <span>include/mpx/serial.h — lines 13-24</span>
        <button class="copy-btn">copy</button>
      </div>
<pre><span class="kw">typedef struct</span> <span class="type">cmd_node</span> {
    <span class="type">char</span> command[MAX_CMD_LENGTH];
    <span class="kw">struct</span> <span class="type">cmd_node</span> *next;
    <span class="kw">struct</span> <span class="type">cmd_node</span> *prev;
} <span class="type">cmd_node_t</span>;

<span class="kw">typedef struct</span> <span class="type">cmd_history</span> {
    <span class="type">cmd_node_t</span> nodes[HISTORY_SIZE];
    <span class="type">cmd_node_t</span> *head;
    <span class="type">cmd_node_t</span> *tail;
    <span class="type">size_t</span> count;
} <span class="type">cmd_history_t</span>;</pre>
    </div>
  </div>

  <div class="subsection">
    <h3>Fix #1: Initialize History</h3>
    <p>The <code>init_history()</code> function exists but is <strong>never called</strong>. Add it to <code>kmain.c</code>.</p>

    <div class="code-block">
      <div class="code-block-header">
        <span>kernel/kmain.c — add at line 57 (the TODO comment)</span>
        <button class="copy-btn">copy</button>
      </div>
<pre><span class="cmt">// Current code at line 57:</span>
<span class="cmt">// TODO init command history</span>

<span class="cmt">// Replace with:</span>
<span class="kw">extern</span> <span class="type">cmd_history_t</span> history;
<span class="fn">init_history</span>(&amp;history);
<span class="fn">klogv</span>(COM1, <span class="str">"Initialized command history..."</span>);</pre>
    </div>

    <div class="gotcha">
      <div class="gotcha-label">GOTCHA</div>
      <p>The <code>history</code> variable is declared in <code>serial.c</code> (line 122), so you need the <code>extern</code> declaration to reference it from <code>kmain.c</code>.</p>
    </div>
  </div>

  <div class="subsection">
    <h3>Fix #2: Ghost Character Bug</h3>
    <p>When you scroll to a command that's <em>shorter</em> than the previous one, old characters remain on screen. The TODO at <code>serial.c:219</code> describes the fix: clear the entire line before redrawing.</p>

    <div class="code-block">
      <div class="code-block-header">
        <span>kernel/serial.c — replace lines 219-233 (up arrow handler)</span>
        <button class="copy-btn">copy</button>
      </div>
<pre><span class="kw">if</span> (cur_cmd) {
    <span class="cmt">// Fix ghost chars: move to start, overwrite with spaces, move back</span>
    <span class="fn">serial_out</span>(dev, <span class="str">"\r"</span>, <span class="num">1</span>);
    <span class="cmt">// Overwrite prompt + old input with spaces</span>
    <span class="kw">for</span> (<span class="type">size_t</span> j = <span class="num">0</span>; j &lt; data_length + <span class="num">2</span>; j++) {  <span class="cmt">// +2 for "> " prompt</span>
        <span class="fn">serial_out</span>(dev, <span class="str">" "</span>, <span class="num">1</span>);
    }
    <span class="fn">serial_out</span>(dev, <span class="str">"\r"</span>, <span class="num">1</span>);

    <span class="cmt">// Reprint prompt</span>
    <span class="fn">serial_out</span>(dev, <span class="str">"&gt; "</span>, <span class="num">2</span>);

    <span class="cmt">// Copy command into buffer</span>
    <span class="type">size_t</span> len = <span class="num">0</span>;
    <span class="kw">while</span> (len &lt; MAX_CMD_LENGTH - <span class="num">1</span> &amp;&amp; cur_cmd-&gt;command[len] != <span class="str">'\0'</span>) {
        buffer[len] = cur_cmd-&gt;command[len];
        len++;
    }
    buffer[len] = <span class="str">'\0'</span>;
    data_length = len;
    cur = data_length;

    <span class="cmt">// Print the command</span>
    <span class="fn">serial_out</span>(dev, buffer, data_length);
}</pre>
    </div>

    <div class="tip">
      <div class="tip-label">TIP</div>
      <p>Apply the same ghost-character fix to the <strong>down arrow handler</strong> (case 'B', around line 237). The pattern is identical: <code>\r</code>, overwrite with spaces, <code>\r</code>, reprint prompt, then print the new command.</p>
    </div>
  </div>
</div>
</section>

<!-- ====== FEATURE D: CLEAR COMMAND ====== -->
<section id="feature-d">
<div class="feature-section">
  <div class="feature-header">
    <span class="badge">D</span>
    <h2>Clear Command</h2>
    <div class="pills">
      <span class="pill pill-pts">5 pts</span>
      <span class="pill pill-easy">Easiest</span>
    </div>
  </div>

  <div class="subsection">
    <h3>Overview</h3>
    <p>Clear the terminal screen. This is literally a two-line function that sends an ANSI escape sequence. The hard part is just wiring it into the build system.</p>
  </div>

  <div class="subsection">
    <h3>Files to Create/Modify</h3>
    <ul class="file-list">
      <li><span class="file-path">user/cmd_clear.c</span> <em>(new)</em> &mdash; The command implementation</li>
      <li><span class="file-path">include/cmd_clear.h</span> <em>(new)</em> &mdash; Header with prototype</li>
      <li><span class="file-path">user/comhand.c</span> &mdash; Add dispatch entry</li>
      <li><span class="file-path">make/user.mk</span> &mdash; Add .o target</li>
    </ul>
  </div>

  <div class="subsection">
    <h3>Implementation</h3>

    <h4>Step 1: Create the header</h4>
    <div class="code-block">
      <div class="code-block-header">
        <span>include/cmd_clear.h</span>
        <button class="copy-btn">copy</button>
      </div>
<pre><span class="prep">#ifndef CMD_CLEAR_H</span>
<span class="prep">#define CMD_CLEAR_H</span>

<span class="kw">void</span> <span class="fn">cmd_clear</span>(<span class="kw">void</span>);

<span class="prep">#endif</span></pre>
    </div>

    <h4>Step 2: Create the implementation</h4>
    <div class="code-block">
      <div class="code-block-header">
        <span>user/cmd_clear.c</span>
        <button class="copy-btn">copy</button>
      </div>
<pre><span class="prep">#include</span> <span class="str">&lt;cmd_clear.h&gt;</span>
<span class="prep">#include</span> <span class="str">&lt;sys_req.h&gt;</span>
<span class="prep">#include</span> <span class="str">&lt;mpx/device.h&gt;</span>

<span class="kw">void</span> <span class="fn">cmd_clear</span>(<span class="kw">void</span>)
{
    <span class="cmt">// \033[2J = clear entire screen</span>
    <span class="cmt">// \033[H  = move cursor to top-left (row 1, col 1)</span>
    <span class="fn">print</span>(<span class="str">"\033[2J\033[H"</span>);
}</pre>
    </div>

    <h4>Step 3: Add dispatch in comhand.c</h4>
    <p>Add before the <code>else</code> (unknown command) block at line 150:</p>
    <div class="code-block">
      <div class="code-block-header">
        <span>user/comhand.c — add before the final else</span>
        <button class="copy-btn">copy</button>
      </div>
<pre><span class="cmt">// ... after the last else-if ...</span>
<span class="kw">else if</span> (<span class="fn">strcmp</span>(cmd, <span class="str">"clear"</span>) == <span class="num">0</span>)
{
    <span class="fn">cmd_clear</span>();
}
<span class="kw">else</span>
{
    <span class="cmt">// unknown command</span>
    <span class="fn">print</span>(<span class="str">"Unknown command: "</span>);
    ...</pre>
    </div>

    <h4>Step 4: Update the Makefile</h4>
    <p>Add the dependency rule and object to <code>make/user.mk</code>:</p>
    <div class="code-block">
      <div class="code-block-header">
        <span>make/user.mk — additions</span>
        <button class="copy-btn">copy</button>
      </div>
<pre><span class="cmt"># Add dependency rule (anywhere before USER_OBJECTS)</span>
user/cmd_clear.o: user/cmd_clear.c include/cmd_clear.h \
  include/sys_req.h include/mpx/device.h

<span class="cmt"># Add to USER_OBJECTS list:</span>
USER_OBJECTS=\
	...
	user/cmd_clear.o\
	user/comhand.o\
	user/cmd_helpers.o</pre>
    </div>
  </div>

  <div class="tip">
    <div class="tip-label">TIP</div>
    <p>Don't forget to <code>#include &lt;cmd_clear.h&gt;</code> in <code>comhand.c</code> too! Also add <code>"clear"</code> to the help command output if you want it listed.</p>
  </div>
</div>
</section>

<!-- ====== FEATURE E: ALIAS COMMAND ====== -->
<section id="feature-e">
<div class="feature-section">
  <div class="feature-header">
    <span class="badge">E</span>
    <h2>Alias Command</h2>
    <div class="pills">
      <span class="pill pill-pts">5 pts</span>
      <span class="pill pill-hard">Med-Hard</span>
    </div>
  </div>

  <div class="subsection">
    <h3>Overview</h3>
    <p>Let users create shorthand names for existing commands (e.g., <code>alias v version</code> makes <code>v</code> run <code>version</code>). Uses a static array &mdash; no dynamic memory needed.</p>
  </div>

  <div class="subsection">
    <h3>Files to Create/Modify</h3>
    <ul class="file-list">
      <li><span class="file-path">user/cmd_alias.c</span> <em>(new)</em> &mdash; Alias storage and lookup</li>
      <li><span class="file-path">include/cmd_alias.h</span> <em>(new)</em> &mdash; Header with prototypes</li>
      <li><span class="file-path">user/comhand.c</span> &mdash; Add alias resolution before dispatch + add alias/unalias commands</li>
      <li><span class="file-path">make/user.mk</span> &mdash; Add .o target</li>
    </ul>
  </div>

  <div class="subsection">
    <h3>Implementation</h3>

    <h4>Step 1: Create the header</h4>
    <div class="code-block">
      <div class="code-block-header">
        <span>include/cmd_alias.h</span>
        <button class="copy-btn">copy</button>
      </div>
<pre><span class="prep">#ifndef CMD_ALIAS_H</span>
<span class="prep">#define CMD_ALIAS_H</span>

<span class="prep">#define MAX_ALIASES 16</span>
<span class="prep">#define MAX_ALIAS_LEN 32</span>

<span class="kw">typedef struct</span> {
    <span class="type">char</span> alias[MAX_ALIAS_LEN];
    <span class="type">char</span> command[MAX_ALIAS_LEN];
} <span class="type">alias_entry_t</span>;

<span class="cmt">// Look up an alias. Returns the real command, or NULL if not found.</span>
<span class="kw">const</span> <span class="type">char</span> *<span class="fn">alias_lookup</span>(<span class="kw">const</span> <span class="type">char</span> *name);

<span class="cmt">// Add or update an alias. Returns 0 on success, -1 if table full.</span>
<span class="type">int</span> <span class="fn">alias_set</span>(<span class="kw">const</span> <span class="type">char</span> *name, <span class="kw">const</span> <span class="type">char</span> *command);

<span class="cmt">// Remove an alias. Returns 0 on success, -1 if not found.</span>
<span class="type">int</span> <span class="fn">alias_remove</span>(<span class="kw">const</span> <span class="type">char</span> *name);

<span class="cmt">// Print all aliases.</span>
<span class="kw">void</span> <span class="fn">alias_list</span>(<span class="kw">void</span>);

<span class="prep">#endif</span></pre>
    </div>

    <h4>Step 2: Create the implementation</h4>
    <div class="code-block">
      <div class="code-block-header">
        <span>user/cmd_alias.c</span>
        <button class="copy-btn">copy</button>
      </div>
<pre><span class="prep">#include</span> <span class="str">&lt;cmd_alias.h&gt;</span>
<span class="prep">#include</span> <span class="str">&lt;string.h&gt;</span>
<span class="prep">#include</span> <span class="str">&lt;sys_req.h&gt;</span>
<span class="prep">#include</span> <span class="str">&lt;mpx/device.h&gt;</span>

<span class="kw">static</span> <span class="type">alias_entry_t</span> aliases[MAX_ALIASES];
<span class="kw">static</span> <span class="type">int</span> alias_count = <span class="num">0</span>;

<span class="kw">const</span> <span class="type">char</span> *<span class="fn">alias_lookup</span>(<span class="kw">const</span> <span class="type">char</span> *name)
{
    <span class="kw">for</span> (<span class="type">int</span> i = <span class="num">0</span>; i &lt; alias_count; i++) {
        <span class="kw">if</span> (<span class="fn">strcmp</span>(aliases[i].alias, name) == <span class="num">0</span>)
            <span class="kw">return</span> aliases[i].command;
    }
    <span class="kw">return</span> <span class="num">NULL</span>;
}

<span class="type">int</span> <span class="fn">alias_set</span>(<span class="kw">const</span> <span class="type">char</span> *name, <span class="kw">const</span> <span class="type">char</span> *command)
{
    <span class="cmt">// Update existing alias</span>
    <span class="kw">for</span> (<span class="type">int</span> i = <span class="num">0</span>; i &lt; alias_count; i++) {
        <span class="kw">if</span> (<span class="fn">strcmp</span>(aliases[i].alias, name) == <span class="num">0</span>) {
            <span class="fn">strcpy</span>(aliases[i].command, command);
            <span class="kw">return</span> <span class="num">0</span>;
        }
    }
    <span class="cmt">// Add new alias</span>
    <span class="kw">if</span> (alias_count &gt;= MAX_ALIASES) <span class="kw">return</span> -<span class="num">1</span>;
    <span class="fn">strcpy</span>(aliases[alias_count].alias, name);
    <span class="fn">strcpy</span>(aliases[alias_count].command, command);
    alias_count++;
    <span class="kw">return</span> <span class="num">0</span>;
}

<span class="type">int</span> <span class="fn">alias_remove</span>(<span class="kw">const</span> <span class="type">char</span> *name)
{
    <span class="kw">for</span> (<span class="type">int</span> i = <span class="num">0</span>; i &lt; alias_count; i++) {
        <span class="kw">if</span> (<span class="fn">strcmp</span>(aliases[i].alias, name) == <span class="num">0</span>) {
            <span class="cmt">// Shift remaining entries down</span>
            aliases[i] = aliases[alias_count - <span class="num">1</span>];
            alias_count--;
            <span class="kw">return</span> <span class="num">0</span>;
        }
    }
    <span class="kw">return</span> -<span class="num">1</span>;
}</pre>
    </div>

    <h4>Step 3: Add alias resolution in comhand.c</h4>
    <p>Add <strong>before</strong> the <code>if/else</code> dispatch chain (after line 72), so aliases get resolved transparently:</p>
    <div class="code-block">
      <div class="code-block-header">
        <span>user/comhand.c — add after parsing, before dispatch</span>
        <button class="copy-btn">copy</button>
      </div>
<pre><span class="cmt">// Resolve alias (but don't alias "alias" or "unalias")</span>
<span class="kw">if</span> (<span class="fn">strcmp</span>(cmd, <span class="str">"alias"</span>) != <span class="num">0</span> &amp;&amp; <span class="fn">strcmp</span>(cmd, <span class="str">"unalias"</span>) != <span class="num">0</span>) {
    <span class="kw">const</span> <span class="type">char</span> *real = <span class="fn">alias_lookup</span>(cmd);
    <span class="kw">if</span> (real != <span class="num">NULL</span>) {
        cmd = (<span class="type">char</span> *)real;
    }
}

<span class="cmt">// figure out which command and run it</span>
<span class="kw">if</span> (<span class="fn">strcmp</span>(cmd, <span class="str">"version"</span>) == <span class="num">0</span>)
{
    ...</pre>
    </div>

    <h4>Step 4: Add alias/unalias commands to dispatch</h4>
    <div class="code-block">
      <div class="code-block-header">
        <span>user/comhand.c — add to the if/else chain</span>
        <button class="copy-btn">copy</button>
      </div>
<pre><span class="kw">else if</span> (<span class="fn">strcmp</span>(cmd, <span class="str">"alias"</span>) == <span class="num">0</span>)
{
    <span class="kw">if</span> (arg == <span class="num">NULL</span>) {
        <span class="fn">alias_list</span>();  <span class="cmt">// no args = show all aliases</span>
    } <span class="kw">else</span> {
        <span class="type">char</span> *name = <span class="fn">strtok</span>(arg, <span class="str">" \t"</span>);
        <span class="type">char</span> *target = <span class="fn">strtok</span>(<span class="num">NULL</span>, <span class="str">"\r\n"</span>);
        <span class="kw">if</span> (!name || !target) {
            <span class="fn">print</span>(<span class="str">"Usage: alias &lt;name&gt; &lt;command&gt;\r\n"</span>);
        } <span class="kw">else if</span> (<span class="fn">alias_set</span>(name, target) &lt; <span class="num">0</span>) {
            <span class="fn">print</span>(<span class="str">"Alias table full.\r\n"</span>);
        }
    }
}
<span class="kw">else if</span> (<span class="fn">strcmp</span>(cmd, <span class="str">"unalias"</span>) == <span class="num">0</span>)
{
    <span class="kw">if</span> (arg == <span class="num">NULL</span>) {
        <span class="fn">print</span>(<span class="str">"Usage: unalias &lt;name&gt;\r\n"</span>);
    } <span class="kw">else if</span> (<span class="fn">alias_remove</span>(arg) &lt; <span class="num">0</span>) {
        <span class="fn">print</span>(<span class="str">"Alias not found.\r\n"</span>);
    }
}</pre>
    </div>
  </div>

  <div class="gotcha">
    <div class="gotcha-label">GOTCHA</div>
    <p>Never allow aliasing <code>alias</code> or <code>unalias</code> themselves &mdash; it would make the commands unreachable! Aliases are stored in a static array, so they don't persist across reboots. That's expected behavior for MPX.</p>
  </div>
</div>
</section>

<!-- ====== FEATURE F: OTHER APPROVED ====== -->
<section id="feature-f">
<div class="feature-section">
  <div class="feature-header">
    <span class="badge">F</span>
    <h2>Other Approved Features</h2>
    <div class="pills">
      <span class="pill pill-pts">5 pts</span>
      <span class="pill pill-medium">Varies</span>
    </div>
  </div>

  <div class="subsection">
    <h3>Overview</h3>
    <p>Propose a custom feature to your instructor for approval. Here are some ideas with implementation sketches:</p>
  </div>

  <div class="subsection">
    <h4>Tab Completion</h4>
    <p>When the user presses Tab, search the command list for a prefix match and auto-complete.</p>
    <div class="code-block">
      <div class="code-block-header">
        <span>Sketch — Tab handler in serial_poll()</span>
        <button class="copy-btn">copy</button>
      </div>
<pre><span class="cmt">// In serial_poll(), add a case for Tab (0x09)</span>
<span class="kw">if</span> (byte == <span class="str">'\t'</span>) {
    <span class="cmt">// Array of all known commands</span>
    <span class="kw">static const</span> <span class="type">char</span> *cmds[] = {
        <span class="str">"help"</span>, <span class="str">"version"</span>, <span class="str">"shutdown"</span>, <span class="str">"getdate"</span>,
        <span class="str">"setdate"</span>, <span class="str">"gettime"</span>, <span class="str">"settime"</span>, <span class="str">"clear"</span>, <span class="num">NULL</span>
    };
    <span class="cmt">// Find first prefix match</span>
    <span class="kw">for</span> (<span class="type">int</span> i = <span class="num">0</span>; cmds[i]; i++) {
        <span class="kw">if</span> (<span class="fn">strncmp</span>(buffer, cmds[i], data_length) == <span class="num">0</span>) {
            <span class="cmt">// Autocomplete: append remaining chars</span>
            ...
            <span class="kw">break</span>;
        }
    }
    <span class="kw">continue</span>;
}</pre>
    </div>
  </div>

  <div class="subsection">
    <h4>Command Timing</h4>
    <p>Show how long each command takes using the RTC. Read the time before and after command execution.</p>
    <div class="code-block">
      <div class="code-block-header">
        <span>Sketch — timing in comhand.c</span>
        <button class="copy-btn">copy</button>
      </div>
<pre><span class="cmt">// Before command dispatch:</span>
<span class="type">int</span> start_sec = <span class="fn">rtc_get_seconds</span>();

<span class="cmt">// ... dispatch command ...</span>

<span class="cmt">// After command returns:</span>
<span class="type">int</span> end_sec = <span class="fn">rtc_get_seconds</span>();
<span class="type">int</span> elapsed = end_sec - start_sec;
<span class="fn">print</span>(<span class="str">"[completed in "</span>);
<span class="cmt">// ... print elapsed ...</span>
<span class="fn">print</span>(<span class="str">" seconds]\r\n"</span>);</pre>
    </div>
  </div>

  <div class="subsection">
    <h4>Custom Prompt</h4>
    <p>Let users change the shell prompt from <code>&gt; </code> to something custom.</p>
    <div class="code-block">
      <div class="code-block-header">
        <span>Sketch — prompt customization</span>
        <button class="copy-btn">copy</button>
      </div>
<pre><span class="cmt">// Global prompt variable</span>
<span class="kw">static</span> <span class="type">char</span> prompt[<span class="num">32</span>] = <span class="str">"&gt; "</span>;

<span class="cmt">// In comhand() loop, replace print("&gt; ") with:</span>
<span class="fn">print</span>(prompt);

<span class="cmt">// Add "prompt" command:</span>
<span class="kw">else if</span> (<span class="fn">strcmp</span>(cmd, <span class="str">"prompt"</span>) == <span class="num">0</span>) {
    <span class="kw">if</span> (arg) <span class="fn">strcpy</span>(prompt, arg);
}</pre>
    </div>
  </div>

  <div class="tip">
    <div class="tip-label">TIP</div>
    <p>You only get points for 4 bonus features maximum (20 pts total). Pick the ones that interest you most or that complement each other.</p>
  </div>
</div>
</section>

<!-- ====== ANSI REFERENCE ====== -->
<section id="ansi-ref">
  <p class="section-title">$ man ansi-codes</p>
  <h2>ANSI Escape Code Quick Reference</h2>

  <p>All codes begin with <code>\033[</code> (ESC + <code>[</code>). In C strings: <code>"\033[CODEm"</code>.</p>

  <h3>Text Colors (Foreground)</h3>
  <table class="ansi-table">
    <thead>
      <tr><th>Code</th><th>Color</th><th>C String</th></tr>
    </thead>
    <tbody>
      <tr><td>30</td><td>Black</td><td><code>\033[30m</code></td></tr>
      <tr><td>31</td><td style="color:#ff3333">Red</td><td><code>\033[31m</code></td></tr>
      <tr><td>32</td><td style="color:#00ff41">Green</td><td><code>\033[32m</code></td></tr>
      <tr><td>33</td><td style="color:#ffb000">Yellow</td><td><code>\033[33m</code></td></tr>
      <tr><td>34</td><td style="color:#5588ff">Blue</td><td><code>\033[34m</code></td></tr>
      <tr><td>35</td><td style="color:#b388ff">Magenta</td><td><code>\033[35m</code></td></tr>
      <tr><td>36</td><td style="color:#00d4ff">Cyan</td><td><code>\033[36m</code></td></tr>
      <tr><td>37</td><td>White</td><td><code>\033[37m</code></td></tr>
    </tbody>
  </table>

  <h3>Background Colors</h3>
  <table class="ansi-table">
    <thead>
      <tr><th>Code</th><th>Color</th><th>C String</th></tr>
    </thead>
    <tbody>
      <tr><td>40</td><td>Black</td><td><code>\033[40m</code></td></tr>
      <tr><td>41</td><td>Red</td><td><code>\033[41m</code></td></tr>
      <tr><td>42</td><td>Green</td><td><code>\033[42m</code></td></tr>
      <tr><td>43</td><td>Yellow</td><td><code>\033[43m</code></td></tr>
      <tr><td>44</td><td>Blue</td><td><code>\033[44m</code></td></tr>
      <tr><td>45</td><td>Magenta</td><td><code>\033[45m</code></td></tr>
      <tr><td>46</td><td>Cyan</td><td><code>\033[46m</code></td></tr>
      <tr><td>47</td><td>White</td><td><code>\033[47m</code></td></tr>
    </tbody>
  </table>

  <h3>Text Styles</h3>
  <table class="ansi-table">
    <thead>
      <tr><th>Code</th><th>Effect</th><th>C String</th></tr>
    </thead>
    <tbody>
      <tr><td>0</td><td>Reset all</td><td><code>\033[0m</code></td></tr>
      <tr><td>1</td><td>Bold / Bright</td><td><code>\033[1m</code></td></tr>
      <tr><td>4</td><td>Underline</td><td><code>\033[4m</code></td></tr>
      <tr><td>7</td><td>Reverse video</td><td><code>\033[7m</code></td></tr>
    </tbody>
  </table>

  <h3>Cursor Movement</h3>
  <table class="ansi-table">
    <thead>
      <tr><th>Sequence</th><th>Effect</th><th>C String</th></tr>
    </thead>
    <tbody>
      <tr><td>ESC[nA</td><td>Move cursor up n lines</td><td><code>\033[nA</code></td></tr>
      <tr><td>ESC[nB</td><td>Move cursor down n lines</td><td><code>\033[nB</code></td></tr>
      <tr><td>ESC[nC</td><td>Move cursor right n columns</td><td><code>\033[nC</code></td></tr>
      <tr><td>ESC[nD</td><td>Move cursor left n columns</td><td><code>\033[nD</code></td></tr>
      <tr><td>ESC[H</td><td>Move cursor to top-left</td><td><code>\033[H</code></td></tr>
      <tr><td>ESC[r;cH</td><td>Move cursor to row r, col c</td><td><code>\033[r;cH</code></td></tr>
    </tbody>
  </table>

  <h3>Screen Control</h3>
  <table class="ansi-table">
    <thead>
      <tr><th>Sequence</th><th>Effect</th><th>C String</th></tr>
    </thead>
    <tbody>
      <tr><td>ESC[2J</td><td>Clear entire screen</td><td><code>\033[2J</code></td></tr>
      <tr><td>ESC[K</td><td>Clear from cursor to end of line</td><td><code>\033[K</code></td></tr>
      <tr><td>ESC[1K</td><td>Clear from start of line to cursor</td><td><code>\033[1K</code></td></tr>
      <tr><td>ESC[2K</td><td>Clear entire line</td><td><code>\033[2K</code></td></tr>
    </tbody>
  </table>

  <h3>Combining Codes</h3>
  <p>Separate multiple codes with semicolons:</p>
  <div class="code-block">
    <div class="code-block-header">
      <span>Examples</span>
      <button class="copy-btn">copy</button>
    </div>
<pre><span class="fn">print</span>(<span class="str">"\033[1;32mBold Green\033[0m\r\n"</span>);      <span class="cmt">// bold + green</span>
<span class="fn">print</span>(<span class="str">"\033[31;43mRed on Yellow\033[0m\r\n"</span>);   <span class="cmt">// red text, yellow bg</span>
<span class="fn">print</span>(<span class="str">"\033[1;4;36mBold Underline Cyan\033[0m\r\n"</span>); <span class="cmt">// bold + underline + cyan</span></pre>
  </div>
</section>

<!-- ====== FOOTER ====== -->
<footer class="footer">
  T4BF // WVU CS450 // Spring 2026
</footer>
</main>

<script src="js/main.js"></script>
</body>
</html>
